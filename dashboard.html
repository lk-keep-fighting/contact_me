<!doctype html>
<html lang="zh-CN">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="theme-color" content="#0ea5e9">
  <title>联系我 - 管理后台</title>
  <meta name="description" content="管理你的个人介绍页面，一键分享引流">
  <link rel="icon" href="/favicon.svg">
  <script src="/assets/vendor/tailwindcss/tailwindcss.js"></script>
  <link rel="stylesheet" href="/assets/vendor/boxicons/css/boxicons.min.css">
  <link rel="stylesheet" href="/assets/vendor/inter/inter.css">
  <link rel="stylesheet" href="/assets/styles/ui.css">
  <link rel="stylesheet" href="/assets/styles/theme-dark.css">
</head>
<body class="dashboard-body">
  <div class="app-shell">
    <header class="app-header">
      <div class="container app-header-inner">
        <div class="app-brand-group">
          <a href="/" class="app-brand">
            <i class='bx bx-aperture'></i>
            <span>联系我</span>
          </a>
          <span class="badge badge-soft hidden sm:inline-flex items-center gap-1">
            <i class='bx bx-pencil'></i>
            编辑器
          </span>
        </div>
        <div class="app-controls">
          <div id="saveStatus" class="save-indicator hidden md:inline-flex" data-state="saved">
            <span class="status-dot"></span>
            <span data-text>已保存</span>
          </div>
          <button data-preview-toggle="header" type="button" class="btn btn-ghost btn-sm">
            <i class='bx bx-layout'></i>
            <span>
              <span class="sm:hidden">聚焦</span>
              <span class="hidden sm:inline">聚焦编辑</span>
            </span>
          </button>
          <div class="app-primary-actions hidden sm:flex">
            <button id="previewBtn" class="btn btn-outline">
              <i class='bx bx-show'></i>
              <span class="hidden md:inline">预览</span>
            </button>
            <button id="publishBtn" class="btn btn-primary">
              <i class='bx bx-send'></i>
              发布
            </button>
          </div>
          <div class="app-user">
            <div class="flex items-center gap-2">
              <img id="userAvatar" src="/assets/images/default-avatar.svg" alt="avatar" class="h-9 w-9 rounded-full border border-border object-cover">
              <div class="leading-tight">
                <p id="userName" class="text-sm font-medium text-foreground">用户名</p>
                <p class="hidden text-xs text-muted-foreground sm:block">欢迎回来</p>
              </div>
            </div>
            <button id="logoutBtn" class="btn btn-ghost btn-icon" title="退出登录">
              <i class='bx bx-log-out text-lg'></i>
            </button>
          </div>
        </div>
      </div>
    </header>

    <main class="app-main container">
      <div class="layout-grid grid gap-6 lg:grid-cols-[minmax(0,1.35fr)_minmax(0,0.85fr)] xl:grid-cols-[minmax(0,1.55fr)_minmax(0,0.75fr)] 2xl:grid-cols-[minmax(0,1.85fr)_minmax(0,0.7fr)] lg:gap-8">
        <section class="layout-editor space-y-6 lg:space-y-8">
          <div class="card">
            <div class="card-header">
              <div class="section-heading">
                <div>
                  <h2 class="card-title">基本资料</h2>
                  <p class="card-description">完善头像、身份和简介，塑造你的个人品牌形象。</p>
                </div>
                <span class="badge badge-muted hidden sm:inline-flex"><i class='bx bx-time-five mr-1'></i>自动保存中</span>
              </div>
            </div>
            <div class="card-content">
              <div class="grid gap-5">
                <div class="grid gap-4 md:grid-cols-2">
                  <div>
                    <label for="profileName">姓名</label>
                    <input id="profileName" type="text" class="input" placeholder="你的姓名">
                  </div>
                  <div>
                    <label for="profileTitle">身份 / 头衔</label>
                    <input id="profileTitle" type="text" class="input" placeholder="创业者 | 产品经理">
                  </div>
                </div>

                <div>
                  <label for="profileBio">个人简介</label>
                  <textarea id="profileBio" rows="4" class="textarea" placeholder="简单介绍一下自己和你的专业领域..."></textarea>
                </div>

                <div class="grid gap-4 md:grid-cols-[minmax(0,1fr)_minmax(0,260px)] md:items-start">
                  <div>
                    <label for="profileTags">标签</label>
                    <input id="profileTags" type="text" class="input" placeholder="AI, 创业, SaaS (用逗号分隔)">
                    <p class="mt-2 text-xs text-muted-foreground">使用标签帮助访客迅速了解你的专长。</p>
                  </div>
                  <div>
                    <label>头像</label>
                    <div class="flex flex-col items-start gap-4 sm:flex-row sm:items-center">
                      <img id="avatarPreview" src="/assets/images/default-avatar.svg" alt="头像预览" class="h-20 w-20 rounded-full border border-border object-cover shadow-sm">
                      <div class="flex-1 space-y-2">
                        <input id="profileAvatar" type="url" class="input" placeholder="https://example.com/avatar.jpg" readonly>
                        <div id="avatarUploadContainer"></div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>

          <div class="card">
            <div class="card-header">
              <div class="section-heading">
                <div>
                  <h2 class="card-title">联系方式</h2>
                  <p class="card-description">为访客提供与你联络的官方渠道，支持二维码和备注说明。</p>
                </div>
                <button id="addSocialBtn" class="btn btn-primary btn-sm">
                  <i class='bx bx-plus'></i>
                  添加
                </button>
              </div>
            </div>
            <div class="card-content">
              <div id="socialsList" class="section-group">
                <!-- 动态添加的社交链接 -->
              </div>
            </div>
          </div>

          <div class="card">
            <div class="card-header">
              <div class="section-heading">
                <div>
                  <h2 class="card-title">产品 / 服务</h2>
                  <p class="card-description">展示你打磨的核心产品或服务，附带跳转链接与分享文案。</p>
                </div>
                <button id="addProductBtn" class="btn btn-primary btn-sm">
                  <i class='bx bx-plus'></i>
                  添加
                </button>
              </div>
            </div>
            <div class="card-content">
              <div id="productsList" class="section-group">
                <!-- 动态添加的产品 -->
              </div>
            </div>
          </div>
        </section>

        <aside class="layout-aside space-y-6 lg:space-y-8">
          <div class="card">
            <div class="card-header">
              <div class="section-heading">
                <div>
                  <h2 class="card-title">实时预览</h2>
                  <p class="card-description">保存后查看最新页面效果，确保内容呈现符合预期。</p>
                </div>
                <div class="flex flex-wrap items-center justify-end gap-2">
                  <button data-preview-toggle="card" type="button" class="btn btn-ghost btn-sm">
                    <i class='bx bx-layout'></i>
                    <span>聚焦编辑</span>
                  </button>
                  <button id="refreshPreview" type="button" class="btn btn-ghost btn-sm">
                    <i class='bx bx-refresh'></i>
                    刷新
                  </button>
                </div>
              </div>
            </div>
            <div class="card-content">
              <div class="tablet-shell">
                <div class="preview-shell">
                  <iframe id="previewFrame" src="/profile.html?handle=preview" class="h-[560px] w-full border-0"></iframe>
                </div>
              </div>
            </div>
            <div class="card-footer">
              <div class="flex flex-wrap items-center justify-between gap-3 text-sm text-muted-foreground">
                <span class="flex items-center gap-2"><i class='bx bx-mobile text-base'></i> 访客将看到与此一致的视觉效果</span>
                <button id="previewBtnMobile" type="button" class="btn btn-outline btn-sm sm:hidden">
                  即刻预览
                </button>
              </div>
            </div>
          </div>

          <div class="card">
            <div class="card-header">
              <h2 class="card-title">页面设置</h2>
              <p class="card-description">个性化页面地址、主题色与主要动作按钮，一键搞定基础配置。</p>
            </div>
            <div class="card-content space-y-5">
              <div class="grid gap-3 sm:grid-cols-[minmax(0,1fr)_auto] sm:items-end">
                <div class="space-y-2">
                  <label for="profileHandle">页面标识</label>
                  <input id="profileHandle" type="text" class="input" placeholder="your-handle" maxlength="30">
                  <p class="text-xs text-muted-foreground">页面 URL：<span id="handleDomain" class="font-medium text-foreground"></span>/<strong id="handlePreview">your-handle</strong></p>
                </div>
                <button id="copyProfileLink" class="btn btn-outline btn-sm w-full sm:w-auto">
                  <i class='bx bx-link-alt'></i>
                  复制链接
                </button>
              </div>

              <div class="grid gap-4 sm:grid-cols-2">
                <div>
                  <label for="themeColor">主题色</label>
                  <input id="themeColor" type="color" value="#0ea5e9" class="input h-12">
                </div>
                <div class="grid gap-2">
                  <label for="ctaLabel">CTA 按钮</label>
                  <input id="ctaLabel" type="text" class="input" placeholder="按钮文字">
                  <input id="ctaUrl" type="url" class="input" placeholder="https://example.com/action">
                </div>
              </div>
            </div>
            <div class="card-footer text-sm text-muted-foreground">
              <span class="flex items-center gap-2"><i class='bx bx-info-circle'></i> 标识修改后请重新发布以确保链接可用。</span>
            </div>
          </div>

          <div class="card">
            <div class="card-header">
              <h2 class="card-title">数据统计</h2>
              <p class="card-description">掌握页面热度，及时跟进潜在访客。</p>
            </div>
            <div class="card-content">
              <div class="grid gap-3 text-center">
                <div class="text-4xl font-semibold text-sky-600" id="viewCount">0</div>
                <p class="text-sm text-muted-foreground">页面访问量</p>
                <p class="text-xs text-muted-foreground">统计自页面创建以来的总访问次数。</p>
              </div>
            </div>
          </div>
        </aside>
      </div>
    </main>
  </div>

  <dialog id="socialModal">
    <div class="dialog-header">
      <h3 id="socialModalTitle" class="dialog-title">新增联系方式</h3>
      <p class="dialog-description">为不同平台设置合适的展示名称与链接，支持二维码。</p>
    </div>
    <div class="dialog-body">
      <div>
        <label for="socialPlatform">平台</label>
        <select id="socialPlatform" class="select">
          <option value="WeChat">微信</option>
          <option value="WeChatOfficial">微信公众号</option>
          <option value="Weibo">微博</option>
          <option value="LinkedIn">LinkedIn</option>
          <option value="Twitter">Twitter</option>
          <option value="Email">邮箱</option>
          <option value="Phone">电话</option>
          <option value="QQ">QQ</option>
          <option value="Custom">自定义</option>
        </select>
      </div>
      <div>
        <label for="socialLabel">显示名称</label>
        <input id="socialLabel" type="text" class="input" placeholder="个人微信">
      </div>
      <div>
        <label for="socialUrl">链接地址</label>
        <input id="socialUrl" type="text" class="input" placeholder="https://... 或 mailto:...">
      </div>
      <div class="space-y-2">
        <label for="socialQr">二维码图片</label>
        <input id="socialQr" type="url" class="input" placeholder="https://example.com/qr.jpg" readonly>
        <div id="qrUploadContainer"></div>
        <div id="qrPreviewContainer" class="hidden">
          <img id="qrPreview" src="" alt="二维码预览" class="h-32 w-32 rounded-lg border border-border object-cover">
        </div>
      </div>
      <div>
        <label for="socialQrNote">二维码说明</label>
        <input id="socialQrNote" type="text" class="input" placeholder="长按保存二维码">
      </div>
    </div>
    <div class="dialog-footer">
      <button id="cancelSocial" class="btn btn-ghost">取消</button>
      <button id="saveSocial" class="btn btn-primary">保存</button>
    </div>
  </dialog>

  <dialog id="productModal">
    <div class="dialog-header">
      <h3 id="productModalTitle" class="dialog-title">新增产品 / 服务</h3>
      <p class="dialog-description">写下产品亮点，可附带图片、链接与分享文案。</p>
    </div>
    <div class="dialog-body">
      <div>
        <label for="productName">产品名称</label>
        <input id="productName" type="text" class="input" placeholder="我的产品">
      </div>
      <div>
        <label for="productDescription">产品描述</label>
        <textarea id="productDescription" rows="3" class="textarea" placeholder="产品核心价值、适用场景等..."></textarea>
      </div>
      <div class="space-y-2">
        <label for="productImage">产品图片</label>
        <input id="productImage" type="url" class="input" placeholder="https://example.com/product.jpg" readonly>
        <div id="productImageUploadContainer"></div>
        <div id="productImagePreviewContainer" class="hidden">
          <img id="productImagePreview" src="" alt="产品图片预览" class="h-48 w-full rounded-lg border border-border object-cover">
        </div>
      </div>
      <div>
        <label for="productUrl">产品链接</label>
        <input id="productUrl" type="url" class="input" placeholder="https://example.com/product">
      </div>
      <div>
        <label for="productShareText">分享文案</label>
        <input id="productShareText" type="text" class="input" placeholder="推荐这个产品给大家！">
      </div>
    </div>
    <div class="dialog-footer">
      <button id="cancelProduct" class="btn btn-ghost">取消</button>
      <button id="saveProduct" class="btn btn-primary">保存</button>
    </div>
  </dialog>

  <script src="/js/config.js"></script>
  <script src="/assets/vendor/supabase/supabase.js"></script>
  <script src="/js/auth-utils.js"></script>
  <script src="/js/upload.js"></script>
  <script src="/js/dashboard.js"></script>
</body>
</html>
